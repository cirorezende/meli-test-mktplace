# ADR 013 – Observabilidade e Monitoramento

Data: 21/09/2025  
Autor: Ciro Rezende <cirorezende@gmail.com>

**Item:** Estratégia de observabilidade para monitoramento, logging, métricas e tracing do sistema.

**Decisão a ser tomada:** Definir como será implementado o monitoramento da aplicação para garantir visibilidade operacional, detecção proativa de problemas e suporte à resolução de incidentes.

**Possibilidades levantadas:**  

- **Logging básico:** Apenas logs da aplicação sem estruturação.
- **Stack ELK (Elasticsearch, Logstash, Kibana):** Solução completa de logging, requer manutenção.
- **AWS CloudWatch + X-Ray:** Integração nativa com AWS, menor flexibilidade.
- **Observabilidade completa (Logs + Metrics + Traces):** Combinação de ferramentas especializadas.
- **Prometheus + Grafana:** Métricas robustas, mas requer infraestrutura adicional.

**Escolha:** AWS CloudWatch + X-Ray + Structured Logging com correlação de traces.

**Justificativa:**  
Solução nativa AWS que oferece observabilidade completa com menor overhead operacional:

**Structured Logging:**
- Formato JSON com campos padronizados
- Correlation ID (ULID) para rastreamento de requests
- Níveis: ERROR, WARN, INFO, DEBUG
- Campos obrigatórios: timestamp, level, service, correlationId, message

**Métricas (CloudWatch):**
- **Negócio:** Pedidos processados/min, tempo médio de processamento, taxa de sucesso
- **Técnicas:** CPU, memória, latência de APIs, cache hit ratio
- **Integração:** Chamadas à API de CDs, falhas de rede, timeouts
- Alertas automáticos para SLA críticos

**Distributed Tracing (X-Ray):**
- Rastreamento completo de requests através dos módulos
- Identificação de gargalos na integração com API externa
- Mapeamento de dependências e latências
- Correlação automática com logs via correlation ID

**Dashboards:**
- Dashboard operacional: Saúde geral do sistema, alertas ativos
- Dashboard de negócio: KPIs de processamento de pedidos
- Dashboard técnico: Performance de infraestrutura e integrações

**Alertas Críticos:**
- Taxa de erro > 5% em 5 minutos
- Latência P95 > 2 segundos
- API de CDs indisponível > 1 minuto
- Uso de CPU > 80% por 10 minutos