# ADR 016 – Configuração e Gestão de Ambientes

Data: 21/09/2025  
Autor: Ciro Rezende <cirorezende@gmail.com>

**Item:** Estratégia para gestão de configurações e separação de ambientes (desenvolvimento, homologação, produção).

**Decisão a ser tomada:** Definir como as configurações da aplicação serão gerenciadas, versionadas e aplicadas em diferentes ambientes, garantindo segurança e facilidade de manutenção.

**Possibilidades levantadas:**  

- **Arquivos de propriedades:** Simples, mas dificulta gestão de secrets.
- **Variáveis de ambiente:** Flexível, mas pode expor informações sensíveis.
- **AWS Systems Manager Parameter Store:** Integração nativa, versionamento, criptografia.
- **AWS Secrets Manager:** Específico para secrets, rotação automática, mais caro.
- **ConfigMaps + Secrets (Kubernetes):** Não aplicável com Fargate.
- **Configuração híbrida:** Combinação de diferentes abordagens por tipo de dado.

**Escolha:** Arquivos de propriedades.

**Justificativa:**  
Para as primeiras versões do sistema, arquivos de propriedades oferecem a simplicidade necessária para entrega rápida, com caminho claro para evolução futura:

**Estrutura de Configuração:**
- **application.properties:** Configurações base comuns a todos os ambientes
- **application-dev.properties:** Configurações específicas de desenvolvimento
- **application-staging.properties:** Configurações de homologação
- **application-prod.properties:** Configurações de produção

**Benefícios da abordagem:**
1. **Simplicidade máxima:** Zero dependências externas para configuração, facilitando desenvolvimento local e testes
2. **Velocidade de implementação:** Não requer setup de infraestrutura adicional (Parameter Store, Secrets Manager)
3. **Transparência:** Configurações visíveis e versionadas junto com o código
4. **Facilidade de debug:** Valores facilmente inspecionáveis durante desenvolvimento e troubleshooting
5. **Compatibilidade Spring Boot:** Suporte nativo e robusto do framework

**Gestão de Secrets:**
- Secrets sensíveis (senhas de banco, API keys) serão fornecidos via variáveis de ambiente no deployment
- Arquivos de propriedades conterão apenas configurações não-sensíveis
- Uso de placeholders para valores sensíveis: `database.password=${DB_PASSWORD}`

**Estrutura de Configurações:**
```properties
# application.properties
app.name=orders-system
app.max-items-per-order=100
cache.ttl-hours=8
api.cd-service.timeout=5000
api.cd-service.retry-attempts=3

# application-prod.properties
database.url=jdbc:postgresql://${DB_HOST}:5432/orders
cache.redis.host=${REDIS_HOST}
api.cd-service.url=${CD_API_URL}
```

**Migração Futura:**
Esta abordagem estabelece uma base sólida para futura migração para AWS Systems Manager Parameter Store quando o sistema amadurecer.

**Versionamento:**
- Arquivos de configuração versionados junto com o código no Git
- Mudanças de configuração rastreáveis via commits
- Rollback simples através do controle de versão do código