# ADR 017 – Estilo Arquitetural da Orders Application

Data: 21/09/2025  
Autor: Ciro Rezende <cirorezende@gmail.com>

**Item:** Definição do estilo arquitetural interno da aplicação de processamento de pedidos.

**Decisão a ser tomada:** Escolher o padrão arquitetural que organizará a estrutura interna da Orders Application, definindo como os módulos, camadas e componentes se relacionarão entre si.

**Possibilidades levantadas:**  

- **Arquitetura em Camadas (Layered):** Organização tradicional em camadas (presentation, business, data), simples mas com risco de acoplamento.
- **Arquitetura Hexagonal (Ports & Adapters):** Isolamento do core de negócio através de portas e adaptadores, alta testabilidade.
- **Clean Architecture:** Dependências apontando para o centro, regras de negócio isoladas, múltiplas camadas concêntricas.
- **Arquitetura Orientada a Eventos:** Comunicação via eventos, desacoplamento temporal, maior complexidade.
- **Arquitetura MVC Tradicional:** Padrão clássico web, adequado para aplicações simples com interface.

**Escolha:** Arquitetura Hexagonal (Ports & Adapters).

**Justificativa:**  
A Arquitetura Hexagonal oferece o melhor equilíbrio entre simplicidade e qualidade arquitetural para o sistema de processamento de pedidos:

**Benefícios da Arquitetura Hexagonal:**

1. **Isolamento do Core de Negócio:** As regras de negócio (algoritmo de seleção de CD, processamento de pedidos) ficam completamente isoladas de detalhes técnicos
2. **Testabilidade Superior:** Core de negócio pode ser testado sem dependências externas (banco, APIs, cache)
3. **Flexibilidade de Integração:** Fácil substituição de adaptadores (trocar PostgreSQL por outro banco, mudar cliente HTTP)
4. **Simplicidade Conceitual:** Estrutura clara com apenas duas áreas principais: core (domínio) e adaptadores (infraestrutura)
5. **Evolução Incremental:** Permite adicionar novos adaptadores sem impactar o core de negócio

**Estrutura da Aplicação:**

**Core (Hexágono Interno):**
- **Domain:** Entidades de negócio (Order, OrderItem, DistributionCenter)
- **Use Cases:** Casos de uso (ProcessOrder, QueryOrder, SelectDistributionCenter)
- **Ports:** Interfaces que definem contratos (OrderRepository, DistributionCenterService, CacheService)

**Adapters (Hexágono Externo):**
- **Inbound Adapters:** Controllers REST, handlers de eventos
- **Outbound Adapters:** Implementações de repositórios, clientes HTTP, cache Redis
- **Configuration:** Wiring dos adaptadores com as portas

**Organização de Pacotes:**
```
com.orders
├── domain/
│   ├── model/          # Entidades de negócio
│   ├── service/        # Casos de uso
│   └── port/           # Interfaces (portas)
├── adapter/
│   ├── inbound/        # Controllers, handlers
│   ├── outbound/       # Repositórios, clientes
│   └── config/         # Configuração e wiring
```

**Alinhamento com Decisões Anteriores:**
- **Monolito Modular (ADR-005):** Hexagonal organiza internamente o monólito com clara separação de responsabilidades
- **Testabilidade (ADR-014):** Core isolado facilita testes unitários com mocks
- **Simplicidade:** Estrutura conceitual simples, sem múltiplas camadas complexas como Clean Architecture

Esta arquitetura garante que o sistema seja facilmente testável, evolutivo e mantenha o foco nas regras de negócio, enquanto preserva a simplicidade necessária para as primeiras versões.